(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{66876:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return b}});var i=n(85893),r=n(809),a=n.n(r),o=n(30266),s=n(9008),c=n(67294),u=n(3283),l=n.n(u),p=JSON.parse('{"Mt":[{"inputs":[],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"name":"charity","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"maxSales","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"totalSales","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"canBuy","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"hasAccess","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function","constant":true},{"inputs":[],"name":"buy","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"payable","type":"function","payable":true}]}'),d=new(l())(l().givenProvider||"ws://127.0.0.1:7545"),f=new d.eth.Contract(p.Mt,"0x434c9DeAd4E5F861c1bfbd1E14f00D6408Fc4689"),h=n(2212),m={back:"https://gateway.ipfs.io/ipfs/QmcikiCcADivoacpS7S7XjQQ6GdHeAuCpGJu4DViDFbKDt",bump:"https://gateway.ipfs.io/ipfs/QmXdmk8bJgCofbY692v2Sfy2j6dyXcqJEsxd92fG4tHUZ1",edge:"https://gateway.ipfs.io/ipfs/QmSUzx2qFy8au1ucrkyH5PLAECtBhEyQrQaZEWRAJ6wB9e",front:"https://gateway.ipfs.io/ipfs/QmYtTbQ24zGwhLKZ5VtZyimYg6ZoY7gKqu72rvY5rtHe62",ribbon:"https://gateway.ipfs.io/ipfs/QmPZ8FsQr4W7oHedSnhtyKJuz7w8jXPmEKXqxnG7sQGUee",shine:"https://gateway.ipfs.io/ipfs/QmRSdGL3iyzPZbq5i6jxxeZD62XoUZ3ijeBTYDuqAiKrgc",specular:"https://gateway.ipfs.io/ipfs/QmWBytiExLZWv39uxUBU89ryrgrsTvAjXc1zdwjPeVJmRJ"},w=function(){var e=(0,c.useRef)(),t=(0,c.useRef)();return(0,c.useEffect)((function(){var n,i,r;if(e.current){var a=new h.CP7({antialias:!0,alpha:!0,preserveDrawingBuffer:!0}),o=new h.xsS,s=new h.cPb(75,e.current.clientWidth/e.current.clientHeight,.1,500);s.position.z=7.5,a.setSize(e.current.clientWidth,e.current.clientHeight),a.setClearColor(1448485),e.current.innerHTML="",e.current.append(a.domElement);var c=new h.Mig(16777215,.8);o.add(c);[[-3,3,10],[0,3,10],[3,3,10]].map((function(e){var t=new h.Ox3(13421772,.2);t.position.set(e[0],e[1],[2]),o.add(t)}));var u=new h.dpR,l=[m.edge,m.edge,m.edge,m.edge,m.back,m.front].map((function(e){return u.load(e)})),p=u.load(m.shine),d=u.load(m.bump),f=u.load(m.specular),w=new h.DvJ(7,7,.1),y=l.map((function(e,t){var n={color:15658734,emissiveMap:p,bumpMap:d,bumpScale:.002,map:e};return 5===t&&(n.specular=16777215,n.specularMap=f,n.shininess=10),new h.xoR(n)})),b=new h.ZAu,v=new h.Kj0(w,y);b.add(v),o.add(b),b.rotation.set(-.1,.1,.1);var g=new h.ZAu,x=Array.from({length:25},(function(e,t){return t-12.5})).map((function(e){var t=u.load(m.ribbon);t.wrapS=h.rpg,t.wrapT=h.rpg,t.repeat.set(3,1),t.flipY=!0;var n=new h.fHI(15,15,2,128,8,!0),i=new h.vBJ({side:h._Li,map:t}),r=new h.Kj0(n,[i,i]);return r.position.set(0,2*e,0),r.userData.sr=Math.random()*Math.PI,g.add(r),o.add(g),r})),j=new h.SUY,M=new h.iMs,E=new h.FM8,S=function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e};i=function(){s.aspect=e.current.clientWidth/e.current.clientHeight,s.updateProjectionMatrix(),a.setSize(e.current.clientWidth,e.current.clientHeight)},r=function(n){e.current&&t.current&&(t.current.style.left=n.clientX+"px",t.current.style.top=n.clientY+"px",E.x=n.clientX/e.current.clientWidth*2-1,E.y=-n.clientY/e.current.clientHeight*2+1)},window.addEventListener("resize",i),document.addEventListener("mousemove",r),function e(){var i=j.getElapsedTime(),r=.15*i,c=Math.floor(r),u=Math.max(0,Math.min(1.5*r,1));v.rotation.set(0,Math.PI*(S(r%1)+c),0),x.forEach((function(e,t){var n=.03*i,r=t%2==0?-1:1;e.rotation.set(0,2*Math.PI/3*n*r+.2*t,0)})),b.position.set(0,20*S(u)-20,0),b.rotation.set(-.2*Math.sin(6.5*r),.2*Math.sin(5.5*r),0),M.setFromCamera(E,s),M.intersectObjects([v]).length>0?t.current.classList.add("show"):t.current.classList.remove("show"),a.render(o,s),n=requestAnimationFrame(e)}()}return function(){cancelAnimationFrame(n),window.removeEventListener("resize",i),document.removeEventListener("mousemove",r)}}),[e]),(0,i.jsxs)("div",{className:"cover",children:[(0,i.jsxs)("div",{className:"sign",ref:t,children:[(0,i.jsx)("span",{children:"Just"}),(0,i.jsx)("span",{className:"amount",children:"0.01"}),(0,i.jsx)("span",{children:"ETH"})]}),(0,i.jsx)("div",{className:"box",ref:e})]})},y=function(e){var t=e.accounts,n=e.connect,r=e.buy,a=e.canBuy,o=e.hasAccess,s=e.download,c=(0,i.jsx)("button",{onClick:n,children:"Connect wallet to buy"});return t.length>0&&(c=o?(0,i.jsx)("button",{onClick:s,children:"Download"}):a?(0,i.jsx)("button",{onClick:r,children:"Buy for 0.01 ETH"}):(0,i.jsx)("button",{disabled:!0,children:"Sold out"})),(0,i.jsx)("footer",{children:c})};function b(){var e=(0,c.useState)([]),t=e[0],n=e[1],r=(0,c.useState)(!1),u=r[0],l=r[1],p=(0,c.useState)(0),h=p[0],m=p[1],b=(0,c.useState)(!1),v=b[0],g=b[1],x=function(){t.length>0?f.methods.hasAccess().call({from:t[0]}).then(g):g(!1)},j=function(){var e=(0,o.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f.methods.canBuy().call().then(l),f.methods.totalSales().call().then(m);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=(0,o.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length>0)){e.next=14;break}return e.prev=1,e.next=4,f.methods.buy().send({from:t[0],value:d.utils.toWei("0.01","ether")});case 4:e.sent,x(),j(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),alert(e.t0);case 12:e.next=15;break;case 14:alert("You need to login!");case 15:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=(0,o.Z)(a().mark((function e(){var n,i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length>0)){e.next=19;break}return e.next=3,d.eth.personal.sign("This is to confirm your account when downloading the limited edition album",t[0]);case 3:return n=e.sent,e.prev=4,e.next=7,fetch("/api/download",{method:"POST",body:JSON.stringify({signature:n})});case 7:return i=e.sent,e.next=10,i.json();case 10:r=e.sent,window.location.href=r.url,e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),alert("incorrect download url");case 17:e.next=20;break;case 19:alert("must be logged in");case 20:case"end":return e.stop()}}),e,null,[[4,14]])})));return function(){return e.apply(this,arguments)}}();return(0,c.useEffect)((function(){window.ethereum?(window.ethereum.request({method:"eth_accounts"}).then(n),window.ethereum.on("accountsChanged",n)):alert("You need to install a wallet!")}),[]),(0,c.useEffect)((function(){window.ethereum&&(x(),j())}),[t]),(0,i.jsxs)("main",{children:[(0,i.jsx)("div",{className:"label",children:"OA Records"}),(0,i.jsx)(w,{}),(0,i.jsxs)("header",{className:"App-header",children:[(0,i.jsx)("img",{src:"https://prism-one.vercel.app/_next/image?url=%2F_next%2Fstatic%2Fimage%2Fpublic%2Flogo.7543c31f9b5458c786301c1334d8b921.svg&w=96&q=75",className:"logo"}),(0,i.jsx)("h1",{children:"The debut album from Prism"}),(0,i.jsxs)("h2",{children:[h," / 100 sold"]}),(0,i.jsx)("p",{children:"Available in a limited edition, holographic digital format through OA Records."}),(0,i.jsx)("p",{children:"20% of all revenue will go directly to the Electronic Frontier Foundation."})]}),(0,i.jsx)(y,{accounts:t,connect:function(){window.ethereum.request({method:"eth_requestAccounts"}).then(n)},buy:M,canBuy:u,hasAccess:v,download:E}),(0,i.jsxs)(s.default,{children:[(0,i.jsx)("title",{children:"Prism \u2013 the debut album, available in a limited edition"}),(0,i.jsx)("meta",{property:"og:title",content:"Prism \u2013 the debut album, available in a limited edition"}),(0,i.jsx)("meta",{property:"og:description",content:"This is a project on the SuperHi Crypto + Web3 course"}),(0,i.jsx)("meta",{property:"og:url",content:"https://www.prism-band.com"}),(0,i.jsx)("meta",{property:"og:image",content:"https://gateway.ipfs.io/ipfs/QmR2sjejZckToA3ic8K8FypPQ9yPsdFo7K8TgDWzQKLLfU"})]})]})}},78581:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(66876)}])},62859:function(){},75304:function(){},46601:function(){},89214:function(){},71922:function(){},2363:function(){},96419:function(){},56353:function(){},69386:function(){},31616:function(){},29120:function(){},46586:function(){},6567:function(){},69862:function(){},40964:function(){},71408:function(){},23646:function(){},43503:function(){},33557:function(){}},function(e){e.O(0,[482,737,370,774,888,179],(function(){return t=78581,e(e.s=t);var t}));var t=e.O();_N_E=t}]);